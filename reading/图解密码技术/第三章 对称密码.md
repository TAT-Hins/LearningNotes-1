## 异或（XOR、exclusive or）

两个相同的数进行 XOR 运算结果一定为 0 。
A 与 B 异或的结果再与 B 进行异或，结果一定是 A。

* 将明文 A 用密钥 B 进行加密，得到密文 A && B
* 将密文 A && B 用密钥 B 进行解密，得到明文 A

所以只要选择合适的 B，仅仅使用 XOR 就可以实现一个高强度的密码。

## 一次性密码本（one-time pad）——绝对不会被破译的密码

**原理：** 将明文与一串随机的比特序列进行 XOR 运算

只要通过暴力破解法对密钥空间进行遍历，无论什么密文总有一天也都能够被破译。然而，即使能够解密出明文，我们也无法判断它是否是正确的明文。因此一次性密码本是无法破译的。

一次性密码本是无条件安全的，在理论上是无法破译的。

### 为什么没有被使用

* 密钥的配送
    
    如果有一种方法可以将密钥安全的发送给对方，岂不是也可以用同样的方法来安全的发送明文了吗?

* 密钥的保存

    一次性密码本中，密钥的长度必须和明文长度相等。为了保护明文，就需要保护和明文一样长的密文。也就是说，我们只是将“保护明文”这一命题换成了“保护密钥”，问题并没有得到实质性的解决。
    
* 密钥的重用

    在一次性密码本中绝对不能重用过去用过的随机比特序列。因为作为密钥的比特序列一旦泄露，过去所有的机密通信内容将全部被解密。
    
* 密钥的同步

    发送者与接收者之间密钥同步的问题。在通信过程中，发送者和接收者的密钥的比特序列不允许有任何错位，否则错位的比特后的所有信息都将无法解密。
    
* 密钥的生成

    在一次性密码本中，需要生成大量的随机数。这里的随机数并不是通过计算机程序生成的伪随机数，而必须是无重现性的真正随机数，
    
    
能够使用一次性密码本的，只有那些机密性重过一切，且可以花费大量财力和人力生成并配送密钥的场合。

## DES 

**DES（Data Encryption Standard）** 是 1977 年美国联邦信息处理标准中所采用的一种对称密码。随着计算机的进步，现在 DES 已经能够被暴力破解，强度大不如前了。除了用它来解密以前的密文以外，**不应该再使用 DES** 。

DES 是一种将 64 比特的明文加密成 64 比特的密文的对称密码算法。它的密钥长度是 64 位，但由于每隔 7 比特会设置一个用于错误检查的比特，因此实质上其密钥长度是 56 比特。

### DES 的结构（Feistel 网络）

DES 的基本结构是由 Horst Feistel 设计的，因此也称为 **Feistel 网络** 。

在 Feistel 网络中，加密的各个步骤称为 **轮（round）**。整个加密过程就是进行若干次轮的循环。DES 是一种 16 轮循环的 Fesitel 网络。每一轮都需要使用一个不同的子密钥。

一轮的具体计算步骤：

* 将输入的数据等分为左右两部分
* 将输入的右侧直接发送到输出的右侧
* 将输入的右侧发送到轮函数
* 轮函数根据右侧数据和子密钥，计算出一串看上去是随机的比特序列
* 将上一步得到的比特序列与左侧数据进行 XOR 运算，并将结果作为加密后的左侧

这样一来 右侧 根本没有加密，因此需要用不用的子密钥对一轮的处理重复若干次，并在每两轮处理之间将左侧和右侧的数据对调。

Feistel 网络的解密过程与加密相同，只需要按照相反的顺序来使用子密钥就可以了。

Feistel 网络特点:

* 轮数可以任意增加
* 加密时无论使用任何函数作为轮函数都可以正确解密
* 加密和解密可以用完全相同的结构来实现

综上：

> 无论是任何轮数、任何轮函数，Feistel 网络都可以用相同的结构实现加密和解密，且加密的结果必定能够正确解密。

**差分分析**：改变一部分明文并分析密文如何随之改变。

**线性分析**：将明文和密文的一些对应比特进行 XOR 并计算其结果为零的概率。

## 三重 DES

**三重 DES（triple-DES）**：将 DES 重复三次所得到的密码算法。

三重 DES 并不是进行三次 DES 加密（加密 -> 加密 -> 加密），而是 加密 -> 解密 -> 加密 的过程，使用三个密钥。目的是为了 **能够兼容普通的 DES**。当三重 DES 中所有的密钥都相同时，就等同于普通的 DES 了。

尽管 三重 DES 目前还被银行等机构使用，但其处理速度不高，除了特别重视向下兼容性的情况外，很少被用于新的用途。

## AES（Advanced Encryption Standard）

在 AES 规格中，分组长度固定为 128 比特，密钥长度只有 128、192 和 256 比特三种。

**Rijndael** 分组密码算法于 2000 年被选为新一代的标准密码算法 —— AES。Rijndael 算法也是由多个 **轮** 组成，每一轮分为了 **SubBytes** 、 **ShiftBytes** 、 **MixColumns** 、 **AddRoundKey** 4 个步骤，使用 SPN结构作为基本结构。

* **SubBytes :** 逐个字节对 16 字节的输入数据进行 SubBytes 处理。就是以每个字节的值（0-255）为索引，从一张拥有 256 个值的替换表（S-Box）中查找出对应制定 处理。
* **ShiftRows :** 以4字节为单位的行按照一定的规则向左平移，且每一行平移的字节数不同。
* **MixColumns :** 对一个 4 字节的值进行比特运算，将其变为另外一个 4 字节值。
* **AddRoundKey :** 将 MixColumns 的输出与轮密钥进行 XOR

输入的所有比特在一轮中都会被加密，与 Feistel 网络相比，优势在于加密所需的轮数更少。

加密过程每一轮的处理：

> SubBytes -> ShiftRows -> MixColumns -> AddRoundKeys

解密过程每一轮的处理：

> AddRoundKeys -> InvMixColumns -> InvShiftRows -> InvSubBytes

**Inv** 代表原始步骤相对应的逆运算。